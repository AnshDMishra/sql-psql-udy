# Generate the Cumulative Standard Normal Distribution Table

We want to generate the Cumulative Standard Normal Distribution Table for `z` score values between `-3.99` to `0.0`. We'll be using the function `pnorm` to calculate the approximation of the CDF. You find the script following this link: [p_norm](./p_norm.sql).


## Negative Z-score CDF Standard Normal Distribution


```console

                    +     |
                 +        |      |
               +          |      |        
            +             |      |
          +   AREA        |      |              
        +   BELOW CURVE   |      |
    +                     |      |
    <--|-----|------------|-----|
-inf -3.9  -3.8  ...     -1.64  0

    z <= -1.64 AREA BELOW CURVE -> 0.050503 (5 %)
```

### Solution

```SQL
WITH RECURSIVE normal
AS (
  SELECT -3.9 AS z
       , pnorm(-3.99)::NUMERIC(7,6) AS _09
       , pnorm(-3.98)::NUMERIC(7,6) AS _08
       , pnorm(-3.97)::NUMERIC(7,6) AS _07
       , pnorm(-3.96)::NUMERIC(7,6) AS _06
       , pnorm(-3.95)::NUMERIC(7,6) AS _05
       , pnorm(-3.94)::NUMERIC(7,6) AS _04
       , pnorm(-3.93)::NUMERIC(7,6) AS _03
       , pnorm(-3.92)::NUMERIC(7,6) AS _02
       , pnorm(-3.91)::NUMERIC(7,6) AS _01
       , pnorm(-3.90)::NUMERIC(7,6) AS _00
  UNION ALL
  SELECT z + 0.1 AS z
       , pnorm(z + 0.1 - 0.09)::NUMERIC(7,6) AS _09
       , pnorm(z + 0.1 - 0.08)::NUMERIC(7,6) AS _08
       , pnorm(z + 0.1 - 0.07)::NUMERIC(7,6) AS _07
       , pnorm(z + 0.1 - 0.06)::NUMERIC(7,6) AS _06
       , pnorm(z + 0.1 - 0.05)::NUMERIC(7,6) AS _05
       , pnorm(z + 0.1 - 0.04)::NUMERIC(7,6) AS _04
       , pnorm(z + 0.1 - 0.03)::NUMERIC(7,6) AS _03
       , pnorm(z + 0.1 - 0.02)::NUMERIC(7,6) AS _02
       , pnorm(z + 0.1 - 0.01)::NUMERIC(7,6) AS _01
       , pnorm(z + 0.1 - 0.00)::NUMERIC(7,6) AS _00
   FROM normal
  WHERE z < 0.0
)
SELECT *
  FROM normal;
```

```console
z    |   _09    |   _08    |   _07    |   _06    |   _05    |   _04    |   _03    |   _02    |   _01    |   _00
-----+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------
-3.9 | 0.000033 | 0.000035 | 0.000036 | 0.000038 | 0.000039 | 0.000041 | 0.000043 | 0.000044 | 0.000046 | 0.000048
-3.8 | 0.000050 | 0.000052 | 0.000055 | 0.000057 | 0.000059 | 0.000062 | 0.000064 | 0.000067 | 0.000070 | 0.000072
-3.7 | 0.000075 | 0.000079 | 0.000082 | 0.000085 | 0.000089 | 0.000092 | 0.000096 | 0.000100 | 0.000104 | 0.000108
-3.6 | 0.000112 | 0.000117 | 0.000121 | 0.000126 | 0.000131 | 0.000136 | 0.000142 | 0.000147 | 0.000153 | 0.000159
-3.5 | 0.000165 | 0.000172 | 0.000179 | 0.000186 | 0.000193 | 0.000200 | 0.000208 | 0.000216 | 0.000224 | 0.000233
-3.4 | 0.000242 | 0.000251 | 0.000260 | 0.000270 | 0.000280 | 0.000291 | 0.000302 | 0.000313 | 0.000325 | 0.000337
-3.3 | 0.000350 | 0.000362 | 0.000376 | 0.000390 | 0.000404 | 0.000419 | 0.000434 | 0.000450 | 0.000467 | 0.000483
-3.2 | 0.000501 | 0.000519 | 0.000538 | 0.000557 | 0.000577 | 0.000598 | 0.000619 | 0.000641 | 0.000664 | 0.000687
-3.1 | 0.000711 | 0.000736 | 0.000762 | 0.000789 | 0.000816 | 0.000845 | 0.000874 | 0.000904 | 0.000935 | 0.000968
-3.0 | 0.001001 | 0.001035 | 0.001070 | 0.001107 | 0.001144 | 0.001183 | 0.001223 | 0.001264 | 0.001306 | 0.001350
-2.9 | 0.001395 | 0.001441 | 0.001489 | 0.001538 | 0.001589 | 0.001641 | 0.001695 | 0.001750 | 0.001807 | 0.001866
-2.8 | 0.001926 | 0.001988 | 0.002052 | 0.002118 | 0.002186 | 0.002256 | 0.002327 | 0.002401 | 0.002477 | 0.002555
-2.7 | 0.002635 | 0.002718 | 0.002803 | 0.002890 | 0.002980 | 0.003072 | 0.003167 | 0.003264 | 0.003364 | 0.003467
-2.6 | 0.003572 | 0.003681 | 0.003792 | 0.003907 | 0.004024 | 0.004145 | 0.004269 | 0.004396 | 0.004527 | 0.004661
-2.5 | 0.004799 | 0.004940 | 0.005085 | 0.005234 | 0.005386 | 0.005543 | 0.005703 | 0.005868 | 0.006036 | 0.006210
-2.4 | 0.006387 | 0.006569 | 0.006756 | 0.006947 | 0.007143 | 0.007344 | 0.007549 | 0.007760 | 0.007976 | 0.008198
-2.3 | 0.008424 | 0.008656 | 0.008894 | 0.009137 | 0.009387 | 0.009642 | 0.009903 | 0.010170 | 0.010444 | 0.010724
-2.2 | 0.011011 | 0.011304 | 0.011604 | 0.011911 | 0.012225 | 0.012546 | 0.012874 | 0.013209 | 0.013553 | 0.013904
-2.1 | 0.014262 | 0.014629 | 0.015004 | 0.015386 | 0.015778 | 0.016177 | 0.016586 | 0.017003 | 0.017429 | 0.017865
-2.0 | 0.018309 | 0.018763 | 0.019226 | 0.019699 | 0.020182 | 0.020675 | 0.021178 | 0.021692 | 0.022216 | 0.022750
-1.9 | 0.023296 | 0.023852 | 0.024419 | 0.024998 | 0.025588 | 0.026190 | 0.026804 | 0.027429 | 0.028067 | 0.028717
-1.8 | 0.029379 | 0.030054 | 0.030742 | 0.031443 | 0.032157 | 0.032884 | 0.033625 | 0.034380 | 0.035148 | 0.035930
-1.7 | 0.036727 | 0.037538 | 0.038364 | 0.039204 | 0.040059 | 0.040930 | 0.041815 | 0.042716 | 0.043633 | 0.044565
-1.6 | 0.045514 | 0.046479 | 0.047460 | 0.048457 | 0.049471 | 0.050503 | 0.051551 | 0.052616 | 0.053699 | 0.054799
-1.5 | 0.055917 | 0.057053 | 0.058207 | 0.059380 | 0.060571 | 0.061780 | 0.063008 | 0.064255 | 0.065522 | 0.066807
-1.4 | 0.068112 | 0.069437 | 0.070781 | 0.072145 | 0.073529 | 0.074934 | 0.076358 | 0.077804 | 0.079270 | 0.080757
-1.3 | 0.082264 | 0.083793 | 0.085343 | 0.086915 | 0.088508 | 0.090123 | 0.091759 | 0.093417 | 0.095098 | 0.096800
-1.2 | 0.098525 | 0.100272 | 0.102042 | 0.103835 | 0.105650 | 0.107488 | 0.109348 | 0.111232 | 0.113139 | 0.115070
-1.1 | 0.117023 | 0.119000 | 0.121000 | 0.123024 | 0.125072 | 0.127143 | 0.129238 | 0.131357 | 0.133499 | 0.135666
-1.0 | 0.137857 | 0.140071 | 0.142310 | 0.144572 | 0.146859 | 0.149170 | 0.151505 | 0.153864 | 0.156248 | 0.158655
-0.9 | 0.161087 | 0.163543 | 0.166023 | 0.168528 | 0.171056 | 0.173609 | 0.176186 | 0.178786 | 0.181411 | 0.184060
-0.8 | 0.186733 | 0.189430 | 0.192150 | 0.194895 | 0.197663 | 0.200454 | 0.203270 | 0.206108 | 0.208970 | 0.211856
-0.7 | 0.214764 | 0.217696 | 0.220650 | 0.223627 | 0.226627 | 0.229650 | 0.232695 | 0.235763 | 0.238852 | 0.241964
-0.6 | 0.245097 | 0.248252 | 0.251429 | 0.254627 | 0.257846 | 0.261086 | 0.264347 | 0.267629 | 0.270931 | 0.274253
-0.5 | 0.277595 | 0.280957 | 0.284339 | 0.287740 | 0.291160 | 0.294598 | 0.298056 | 0.301532 | 0.305026 | 0.308537
-0.4 | 0.312067 | 0.315614 | 0.319177 | 0.322758 | 0.326355 | 0.329968 | 0.333598 | 0.337243 | 0.340903 | 0.344578
-0.3 | 0.348268 | 0.351973 | 0.355691 | 0.359423 | 0.363169 | 0.366928 | 0.370700 | 0.374484 | 0.378280 | 0.382088
-0.2 | 0.385908 | 0.389739 | 0.393580 | 0.397432 | 0.401294 | 0.405165 | 0.409046 | 0.412936 | 0.416834 | 0.420740
-0.1 | 0.424655 | 0.428576 | 0.432505 | 0.436441 | 0.440382 | 0.444330 | 0.448283 | 0.452242 | 0.456205 | 0.460172
0.0  | 0.464144 | 0.468119 | 0.472097 | 0.476078 | 0.480061 | 0.484047 | 0.488034 | 0.492022 | 0.496011 | 0.500000
(40 rows)
```

## Positive Z-score CDF Standard Normal Distribution


```console             

                       *  +  *  
                    +          +  
                 +              |
               +                |        
            +                   |
          +   AREA              |              
        +   BELOW CURVE         |
    +                           |
    <--|-----|------------|-----|
-inf -3.9  -3.8  ...      0      z -> +inf
```


### Solution

```SQL
WITH RECURSIVE normal
AS (
  SELECT 0.0 AS z
       , pnorm(0.00)::NUMERIC(7,6) AS _00
       , pnorm(0.01)::NUMERIC(7,6) AS _01
       , pnorm(0.02)::NUMERIC(7,6) AS _02
       , pnorm(0.03)::NUMERIC(7,6) AS _03
       , pnorm(0.04)::NUMERIC(7,6) AS _04
       , pnorm(0.05)::NUMERIC(7,6) AS _05
       , pnorm(0.06)::NUMERIC(7,6) AS _06
       , pnorm(0.07)::NUMERIC(7,6) AS _07
       , pnorm(0.08)::NUMERIC(7,6) AS _08
       , pnorm(0.09)::NUMERIC(7,6) AS _09
  UNION ALL
  SELECT z + 0.1 AS z
       , pnorm(z + 0.1 + 0.00)::NUMERIC(7,6) AS _00
       , pnorm(z + 0.1 + 0.01)::NUMERIC(7,6) AS _01
       , pnorm(z + 0.1 + 0.02)::NUMERIC(7,6) AS _02
       , pnorm(z + 0.1 + 0.03)::NUMERIC(7,6) AS _03
       , pnorm(z + 0.1 + 0.04)::NUMERIC(7,6) AS _04
       , pnorm(z + 0.1 + 0.05)::NUMERIC(7,6) AS _05
       , pnorm(z + 0.1 + 0.06)::NUMERIC(7,6) AS _06
       , pnorm(z + 0.1 + 0.07)::NUMERIC(7,6) AS _07
       , pnorm(z + 0.1 + 0.08)::NUMERIC(7,6) AS _08
       , pnorm(z + 0.1 + 0.09)::NUMERIC(7,6) AS _09
   FROM normal
  WHERE z < 3.9
)
SELECT *
  FROM normal;
```

```console
z   |   _00    |   _01    |   _02    |   _03    |   _04    |   _05    |   _06    |   _07    |   _08    |   _09
----+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------
0.0 | 0.500000 | 0.503989 | 0.507978 | 0.511966 | 0.515953 | 0.519939 | 0.523922 | 0.527903 | 0.531881 | 0.535856
0.1 | 0.539828 | 0.543795 | 0.547758 | 0.551717 | 0.555670 | 0.559618 | 0.563559 | 0.567495 | 0.571424 | 0.575345
0.2 | 0.579260 | 0.583166 | 0.587064 | 0.590954 | 0.594835 | 0.598706 | 0.602568 | 0.606420 | 0.610261 | 0.614092
0.3 | 0.617912 | 0.621720 | 0.625516 | 0.629300 | 0.633072 | 0.636831 | 0.640577 | 0.644309 | 0.648027 | 0.651732
0.4 | 0.655422 | 0.659097 | 0.662757 | 0.666402 | 0.670032 | 0.673645 | 0.677242 | 0.680823 | 0.684386 | 0.687933
0.5 | 0.691463 | 0.694974 | 0.698468 | 0.701944 | 0.705402 | 0.708840 | 0.712260 | 0.715661 | 0.719043 | 0.722405
0.6 | 0.725747 | 0.729069 | 0.732371 | 0.735653 | 0.738914 | 0.742154 | 0.745373 | 0.748571 | 0.751748 | 0.754903
0.7 | 0.758036 | 0.761148 | 0.764237 | 0.767305 | 0.770350 | 0.773373 | 0.776373 | 0.779350 | 0.782304 | 0.785236
0.8 | 0.788144 | 0.791030 | 0.793892 | 0.796730 | 0.799546 | 0.802337 | 0.805105 | 0.807850 | 0.810570 | 0.813267
0.9 | 0.815940 | 0.818589 | 0.821214 | 0.823814 | 0.826391 | 0.828944 | 0.831472 | 0.833977 | 0.836457 | 0.838913
1.0 | 0.841345 | 0.843752 | 0.846136 | 0.848495 | 0.850830 | 0.853141 | 0.855428 | 0.857690 | 0.859929 | 0.862143
1.1 | 0.864334 | 0.866501 | 0.868643 | 0.870762 | 0.872857 | 0.874928 | 0.876976 | 0.879000 | 0.881000 | 0.882977
1.2 | 0.884930 | 0.886861 | 0.888768 | 0.890652 | 0.892512 | 0.894350 | 0.896165 | 0.897958 | 0.899728 | 0.901475
1.3 | 0.903200 | 0.904902 | 0.906583 | 0.908241 | 0.909877 | 0.911492 | 0.913085 | 0.914657 | 0.916207 | 0.917736
1.4 | 0.919243 | 0.920730 | 0.922196 | 0.923642 | 0.925066 | 0.926471 | 0.927855 | 0.929219 | 0.930563 | 0.931888
1.5 | 0.933193 | 0.934478 | 0.935745 | 0.936992 | 0.938220 | 0.939429 | 0.940620 | 0.941793 | 0.942947 | 0.944083
1.6 | 0.945201 | 0.946301 | 0.947384 | 0.948449 | 0.949497 | 0.950529 | 0.951543 | 0.952540 | 0.953521 | 0.954486
1.7 | 0.955435 | 0.956367 | 0.957284 | 0.958185 | 0.959070 | 0.959941 | 0.960796 | 0.961636 | 0.962462 | 0.963273
1.8 | 0.964070 | 0.964852 | 0.965620 | 0.966375 | 0.967116 | 0.967843 | 0.968557 | 0.969258 | 0.969946 | 0.970621
1.9 | 0.971283 | 0.971933 | 0.972571 | 0.973196 | 0.973810 | 0.974412 | 0.975002 | 0.975581 | 0.976148 | 0.976704
2.0 | 0.977250 | 0.977784 | 0.978308 | 0.978822 | 0.979325 | 0.979818 | 0.980301 | 0.980774 | 0.981237 | 0.981691
2.1 | 0.982135 | 0.982571 | 0.982997 | 0.983414 | 0.983823 | 0.984222 | 0.984614 | 0.984996 | 0.985371 | 0.985738
2.2 | 0.986096 | 0.986447 | 0.986791 | 0.987126 | 0.987454 | 0.987775 | 0.988089 | 0.988396 | 0.988696 | 0.988989
2.3 | 0.989276 | 0.989556 | 0.989830 | 0.990097 | 0.990358 | 0.990613 | 0.990863 | 0.991106 | 0.991344 | 0.991576
2.4 | 0.991802 | 0.992024 | 0.992240 | 0.992451 | 0.992656 | 0.992857 | 0.993053 | 0.993244 | 0.993431 | 0.993613
2.5 | 0.993790 | 0.993964 | 0.994132 | 0.994297 | 0.994457 | 0.994614 | 0.994766 | 0.994915 | 0.995060 | 0.995201
2.6 | 0.995339 | 0.995473 | 0.995604 | 0.995731 | 0.995855 | 0.995976 | 0.996093 | 0.996208 | 0.996319 | 0.996428
2.7 | 0.996533 | 0.996636 | 0.996736 | 0.996833 | 0.996928 | 0.997020 | 0.997110 | 0.997197 | 0.997282 | 0.997365
2.8 | 0.997445 | 0.997523 | 0.997599 | 0.997673 | 0.997744 | 0.997814 | 0.997882 | 0.997948 | 0.998012 | 0.998074
2.9 | 0.998134 | 0.998193 | 0.998250 | 0.998305 | 0.998359 | 0.998411 | 0.998462 | 0.998511 | 0.998559 | 0.998605
3.0 | 0.998650 | 0.998694 | 0.998736 | 0.998777 | 0.998817 | 0.998856 | 0.998893 | 0.998930 | 0.998965 | 0.998999
3.1 | 0.999032 | 0.999065 | 0.999096 | 0.999126 | 0.999155 | 0.999184 | 0.999211 | 0.999238 | 0.999264 | 0.999289
3.2 | 0.999313 | 0.999336 | 0.999359 | 0.999381 | 0.999402 | 0.999423 | 0.999443 | 0.999462 | 0.999481 | 0.999499
3.3 | 0.999517 | 0.999533 | 0.999550 | 0.999566 | 0.999581 | 0.999596 | 0.999610 | 0.999624 | 0.999638 | 0.999650
3.4 | 0.999663 | 0.999675 | 0.999687 | 0.999698 | 0.999709 | 0.999720 | 0.999730 | 0.999740 | 0.999749 | 0.999758
3.5 | 0.999767 | 0.999776 | 0.999784 | 0.999792 | 0.999800 | 0.999807 | 0.999814 | 0.999821 | 0.999828 | 0.999835
3.6 | 0.999841 | 0.999847 | 0.999853 | 0.999858 | 0.999864 | 0.999869 | 0.999874 | 0.999879 | 0.999883 | 0.999888
3.7 | 0.999892 | 0.999896 | 0.999900 | 0.999904 | 0.999908 | 0.999911 | 0.999915 | 0.999918 | 0.999921 | 0.999925
3.8 | 0.999928 | 0.999930 | 0.999933 | 0.999936 | 0.999938 | 0.999941 | 0.999943 | 0.999945 | 0.999948 | 0.999950
3.9 | 0.999952 | 0.999954 | 0.999956 | 0.999957 | 0.999959 | 0.999961 | 0.999962 | 0.999964 | 0.999965 | 0.999967
(40 rows)
```

- **Solution 2**

```SQL
WITH RECURSIVE normal
AS (
  SELECT -3.9 AS z
       , pnorm(-3.99)::NUMERIC(7,6) AS _09
       , pnorm(-3.98)::NUMERIC(7,6) AS _08
       , pnorm(-3.97)::NUMERIC(7,6) AS _07
       , pnorm(-3.96)::NUMERIC(7,6) AS _06
       , pnorm(-3.95)::NUMERIC(7,6) AS _05
       , pnorm(-3.94)::NUMERIC(7,6) AS _04
       , pnorm(-3.93)::NUMERIC(7,6) AS _03
       , pnorm(-3.92)::NUMERIC(7,6) AS _02
       , pnorm(-3.91)::NUMERIC(7,6) AS _01
       , pnorm(-3.90)::NUMERIC(7,6) AS _00
  UNION ALL
  SELECT z + 0.1 AS z
       , pnorm(z + 0.1 - 0.09)::NUMERIC(7,6) AS _09
       , pnorm(z + 0.1 - 0.08)::NUMERIC(7,6) AS _08
       , pnorm(z + 0.1 - 0.07)::NUMERIC(7,6) AS _07
       , pnorm(z + 0.1 - 0.06)::NUMERIC(7,6) AS _06
       , pnorm(z + 0.1 - 0.05)::NUMERIC(7,6) AS _05
       , pnorm(z + 0.1 - 0.04)::NUMERIC(7,6) AS _04
       , pnorm(z + 0.1 - 0.03)::NUMERIC(7,6) AS _03
       , pnorm(z + 0.1 - 0.02)::NUMERIC(7,6) AS _02
       , pnorm(z + 0.1 - 0.01)::NUMERIC(7,6) AS _01
       , pnorm(z + 0.1 - 0.00)::NUMERIC(7,6) AS _00
   FROM normal
  WHERE z < 0.0
)
SELECT  z * (-1) AS z
      , 1 - _00 AS _00
      , 1 - _01 AS _01
      , 1 - _02 AS _02
      , 1 - _03 AS _03
      , 1 - _04 AS _04
      , 1 - _05 AS _05
      , 1 - _06 AS _06
      , 1 - _07 AS _07
      , 1 - _08 AS _08
      , 1 - _09 AS _09
  FROM normal
 ORDER BY z;
```

## Plot the Standard Normal Distribution

```SQL
WITH x AS (
  SELECT '(-inf -4]' AS class
        , pnorm(-4.0)::NUMERIC(7,6) AS prb
  UNION ALL
  SELECT '(-4 -3]' AS class
        , pnorm(-3.0)::NUMERIC(7,6) - pnorm(-4.0)::NUMERIC(7,6) AS prb
  UNION ALL
  SELECT '(-3 -2]' AS class
        , pnorm(-2.0)::NUMERIC(7,6) - pnorm(-3.0)::NUMERIC(7,6) AS prb
  UNION ALL
  SELECT '(-2 -1]' AS class
        , pnorm(-1.0)::NUMERIC(7,6) - pnorm(-2.0)::NUMERIC(7,6) AS prb
  UNION ALL
  SELECT '(-1  0]' AS class
        , pnorm(0.0)::NUMERIC(7,6) - pnorm(-1.0)::NUMERIC(7,6) AS prb
)
SELECT  *
      , SUM(prb) OVER(ORDER BY prb)
  FROM x;
```

```console
class     |   prb    |   sum
----------+----------+----------
(-inf -4] | 0.000032 | 0.000032
(-4 -3]   | 0.001318 | 0.001350
(-3 -2]   | 0.021400 | 0.022750
(-2 -1]   | 0.135905 | 0.158655
(-1  0]   | 0.341345 | 0.500000
(5 rows)
```

Let's round the result:

```SQL
WITH x AS (
  SELECT '(-inf -4]' AS class
        , (pnorm(-4.0)::NUMERIC(4,3))*1000 AS prb
  UNION ALL
  SELECT '(-4 -3]' AS class
        , (pnorm(-3.0)::NUMERIC(4,3) - pnorm(-4.0)::NUMERIC(4,3))*1000 AS prb
  UNION ALL
  SELECT '(-3 -2]' AS class
        , (pnorm(-2.0)::NUMERIC(4,3) - pnorm(-3.0)::NUMERIC(4,3))*1000 AS prb
  UNION ALL
  SELECT '(-2 -1]' AS class
        , (pnorm(-1.0)::NUMERIC(4,3) - pnorm(-2.0)::NUMERIC(4,3))*1000 AS prb
  UNION ALL
  SELECT '(-1  0]' AS class
        , (pnorm(0.0)::NUMERIC(4,3) - pnorm(-1.0)::NUMERIC(4,3))*1000 AS prb
)
SELECT  class
      , prb::INTEGER
      , (SUM(prb) OVER(ORDER BY prb))::INTEGER
  FROM x;
```

```console
class     | prb | sum
----------+-----+-----
(-inf -4] |   0 |   0
(-4 -3]   |   1 |   1
(-3 -2]   |  22 |  23
(-2 -1]   | 136 | 159
(-1  0]   | 341 | 500
```

Let's plot:

```SQL
WITH x AS (
  SELECT '(-inf -4]' AS class
        , (pnorm(-4.0)::NUMERIC(4,3))*1000 AS prb
  UNION ALL
  SELECT '(-4 -3]' AS class
        , (pnorm(-3.0)::NUMERIC(4,3) - pnorm(-4.0)::NUMERIC(4,3))*1000 AS prb
  UNION ALL
  SELECT '(-3 -2]' AS class
        , (pnorm(-2.0)::NUMERIC(4,3) - pnorm(-3.0)::NUMERIC(4,3))*1000 AS prb
  UNION ALL
  SELECT '(-2 -1]' AS class
        , (pnorm(-1.0)::NUMERIC(4,3) - pnorm(-2.0)::NUMERIC(4,3))*1000 AS prb
  UNION ALL
  SELECT '(-1  0]' AS class
        , (pnorm(0.0)::NUMERIC(4,3) - pnorm(-1.0)::NUMERIC(4,3))*1000 AS prb
),
hist AS (
  SELECT  class
        , prb::INTEGER
        , (SUM(prb) OVER(ORDER BY prb))::INTEGER
    FROM x
)
SELECT  *
      ,  LPAD('*',prb::INTEGER,'*') AS prb_plot
  FROM hist;
```

```console
class   | prb | sum |                                                                                                                                                                       prb_plot
-----------+-----+-----+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
(-inf -4] |   0 |   0 |
(-4 -3]   |   1 |   1 | *
(-3 -2]   |  22 |  23 | **********************
(-2 -1]   | 136 | 159 | ****************************************************************************************************************************************
(-1  0]   | 341 | 500 | *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************
```

```SQL
WITH RECURSIVE normal AS (
  SELECT '(-inf -3.0]' AS class
        , -3.0 AS z
        , (pnorm(-3.0)::NUMERIC(4,3)*1000)::INTEGER AS freq
  UNION ALL
  SELECT  CASE WHEN z = 3.0
               THEN '(3.0 +inf)'
               ELSE '(' || z::TEXT || ' ' || (z + 0.25)::TEXT || ']'
          END AS class
        , z + 0.25 AS z
        , CASE WHEN z = 3.0
               THEN  (((1 - pnorm(z))::NUMERIC(4,3))*1000)::INTEGER
               ELSE
              ((pnorm(z + 0.25)::NUMERIC(4,3) - pnorm(z)::NUMERIC(4,3))*1000)::INTEGER
          END AS freq
    FROM normal
   WHERE z <= 3.0
)
SELECT *
      , SUM(freq) OVER(ORDER BY z)
      , ROUND(100*freq/1000.00,1) AS pr
      , ROUND(SUM(100*freq/1000.00) OVER(ORDER BY z),1) AS c_pr
      ,  LPAD('*',freq::INTEGER,'*') AS freq_plot
  FROM normal;
```

```console
class         |   z   | freq | sum  | pr  | c_pr  |                                              freq_plot
--------------+-------+------+------+-----+-------+-----------------------------------------------------------------------------------------------------
(-inf -3.0]   |  -3.0 |    1 |    1 | 0.1 |   0.1 | *
(-3.0 -2.75]  | -2.75 |    2 |    3 | 0.2 |   0.3 | **
(-2.75 -2.50] | -2.50 |    3 |    6 | 0.3 |   0.6 | ***
(-2.50 -2.25] | -2.25 |    6 |   12 | 0.6 |   1.2 | ******
(-2.25 -2.00] | -2.00 |   11 |   23 | 1.1 |   2.3 | ***********
(-2.00 -1.75] | -1.75 |   17 |   40 | 1.7 |   4.0 | *****************
(-1.75 -1.50] | -1.50 |   27 |   67 | 2.7 |   6.7 | ***************************
(-1.50 -1.25] | -1.25 |   39 |  106 | 3.9 |  10.6 | ***************************************
(-1.25 -1.00] | -1.00 |   53 |  159 | 5.3 |  15.9 | *****************************************************
(-1.00 -0.75] | -0.75 |   68 |  227 | 6.8 |  22.7 | ********************************************************************
(-0.75 -0.50] | -0.50 |   82 |  309 | 8.2 |  30.9 | **********************************************************************************
(-0.50 -0.25] | -0.25 |   92 |  401 | 9.2 |  40.1 | ********************************************************************************************
(-0.25 0.00]  |  0.00 |   99 |  500 | 9.9 |  50.0 | ***************************************************************************************************
(0.00 0.25]   |  0.25 |   99 |  599 | 9.9 |  59.9 | ***************************************************************************************************
(0.25 0.50]   |  0.50 |   92 |  691 | 9.2 |  69.1 | ********************************************************************************************
(0.50 0.75]   |  0.75 |   82 |  773 | 8.2 |  77.3 | **********************************************************************************
(0.75 1.00]   |  1.00 |   68 |  841 | 6.8 |  84.1 | ********************************************************************
(1.00 1.25]   |  1.25 |   53 |  894 | 5.3 |  89.4 | *****************************************************
(1.25 1.50]   |  1.50 |   39 |  933 | 3.9 |  93.3 | ***************************************
(1.50 1.75]   |  1.75 |   27 |  960 | 2.7 |  96.0 | ***************************
(1.75 2.00]   |  2.00 |   17 |  977 | 1.7 |  97.7 | *****************
(2.00 2.25]   |  2.25 |   11 |  988 | 1.1 |  98.8 | ***********
(2.25 2.50]   |  2.50 |    6 |  994 | 0.6 |  99.4 | ******
(2.50 2.75]   |  2.75 |    3 |  997 | 0.3 |  99.7 | ***
(2.75 3.00]   |  3.00 |    2 |  999 | 0.2 |  99.9 | **
(3.0 +inf)    |  3.25 |    1 | 1000 | 0.1 | 100.0 | *
```
